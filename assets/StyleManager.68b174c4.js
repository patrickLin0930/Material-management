import{Q as L,b as R}from"./QSelect.be31338a.js";import{l as D,r as g,V as T,aW as J,aX as K,o as O,h as W,m as G,g as H,bc as Y,J as B,t as Z,aS as $,bd as ee,c as F,a5 as h,ah as Q,aa as w,j as i,a7 as _,am as te,aq as X,av as oe,ak as k,a8 as M,F as I,aj as N,a6 as A,a9 as U,ai as x}from"./index.f70666c9.js";import{a as j,Q as ae}from"./QItem.e2ac683b.js";import{Q as le}from"./QList.2c7e7089.js";import{_ as se}from"./plugin-vue_export-helper.21dcd24c.js";import"./QItemLabel.81a1b2d6.js";import"./format.d55e7e59.js";var ne=D({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(r,{slots:o,emit:f}){const a=H(),u=g(null);let c=0;const e=[];function p(t){const m=typeof t=="boolean"?t:r.noErrorFocus!==!0,s=++c,v=(l,d)=>{f(`validation${l===!0?"Success":"Error"}`,d)},n=l=>{const d=l.validate();return typeof d.then=="function"?d.then(y=>({valid:y,comp:l}),y=>({valid:!1,comp:l,err:y})):Promise.resolve({valid:d,comp:l})};return(r.greedy===!0?Promise.all(e.map(n)).then(l=>l.filter(d=>d.valid!==!0)):e.reduce((l,d)=>l.then(()=>n(d).then(y=>{if(y.valid===!1)return Promise.reject(y)})),Promise.resolve()).catch(l=>[l])).then(l=>{if(l===void 0||l.length===0)return s===c&&v(!0),!0;if(s===c){const{comp:d,err:y}=l[0];if(y!==void 0&&console.error(y),v(!1,d),m===!0){const E=l.find(({comp:P})=>typeof P.focus=="function"&&Y(P.$)===!1);E!==void 0&&E.comp.focus()}}return!1})}function S(){c++,e.forEach(t=>{typeof t.resetValidation=="function"&&t.resetValidation()})}function V(t){t!==void 0&&B(t);const m=c+1;p().then(s=>{m===c&&s===!0&&(r.onSubmit!==void 0?f("submit",t):(t==null?void 0:t.target)!==void 0&&typeof t.target.submit=="function"&&t.target.submit())})}function C(t){t!==void 0&&B(t),f("reset"),Z(()=>{S(),r.autofocus===!0&&r.noResetFocus!==!0&&b()})}function b(){$(()=>{if(u.value===null)return;const t=u.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||u.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||u.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(u.value.querySelectorAll("[tabindex]"),m=>m.tabIndex!==-1);t==null||t.focus({preventScroll:!0})})}T(ee,{bindComponent(t){e.push(t)},unbindComponent(t){const m=e.indexOf(t);m!==-1&&e.splice(m,1)}});let q=!1;return J(()=>{q=!0}),K(()=>{q===!0&&r.autofocus===!0&&b()}),O(()=>{r.autofocus===!0&&b()}),Object.assign(a.proxy,{validate:p,resetValidation:S,submit:V,reset:C,focus:b,getValidationComponents:()=>e}),()=>W("form",{class:"q-form",ref:u,onSubmit:V,onReset:C},G(o.default))}});const re={name:"StyleManager",setup(){const r=g(""),o=g(""),f=g([]),a=g([]),u=g(0),c=g(""),e=g([]),p=["\u5167\u8863","\u5167\u8932","\u5176\u4ED6\u5546\u54C1"],S={\u5167\u8863:{colors:["\u9ED1\u8272","\u767D\u8272","\u7D05\u8272","\u85CD\u8272","\u819A\u8272","\u7070\u8272","\u7C89\u8272","\u7D2B\u8272","\u85D5\u7C89","\u8C46\u6C99","\u6843\u8272","\u5496\u8272","\u7DA0\u8272","\u68D7\u7D05","\u82B1\u7070","\u6DF1\u674F","\u6DFA\u674F","\u6697\u7C89","\u6696\u819A","\u9999\u6AB3","\u7D05\u7070","\u8766\u7C89"],sizes:["F","S","M","L","XL","2XL","3XL","4XL","34","36","38","40","42","44","46"]},\u5167\u8932:{colors:["\u9ED1\u8272","\u767D\u8272","\u7D05\u8272","\u85CD\u8272","\u7DA0\u8272","\u7D2B\u8272","\u7C89\u8272","\u8C46\u6C99","\u78DA\u7D05","\u85D5\u7D2B","\u828B\u7C89","\u9152\u7D05","\u65B0\u7DA0","\u9BAE\u8766","\u679C\u7DA0","\u6AFB\u7C89","\u6DFA\u7D2B","\u7070\u7D2B","\u7070\u8272","\u819A\u8272","\u6DFA\u7070","\u6DFA\u5496","\u5AE9\u7C89"],sizes:["F","S","M","L","XL","2XL","3XL","4XL"]},\u5176\u4ED6\u5546\u54C1:{colors:["\u9ED1\u8272","\u767D\u8272","\u7C89\u8272","\u7070\u8272","\u6C92\u984F\u8272"],sizes:["F","XL","2XL","3XL","4XL"]}},V=F(()=>o.value?S[o.value].colors:[]),C=F(()=>o.value?S[o.value].sizes:[]),b=async()=>{const s=await k.styles.toArray(),v={};s.forEach(n=>{v[n.name]||(v[n.name]={category:n.category,combinations:[]}),v[n.name].combinations.push({color:n.color,size:n.size,price:n.price})}),e.value=Object.entries(v).map(([n,z])=>({name:n,category:z.category,combinations:z.combinations}))},q=async()=>{if(!r.value.trim()||!o.value||!f.value.length||!a.value.length||!u.value){alert("\u8ACB\u586B\u5BEB\u6240\u6709\u6B04\u4F4D");return}const s=[];f.value.forEach(v=>{a.value.forEach(n=>{s.push({name:r.value.trim(),category:o.value,color:v,size:n,price:u.value})})}),await k.styles.bulkAdd(s),r.value="",o.value="",f.value=[],a.value=[],u.value=0,await b(),alert("\u2705 \u5DF2\u65B0\u589E\u6B3E\u5F0F")},t=async s=>{confirm(`\u78BA\u5B9A\u8981\u522A\u9664\u6B3E\u865F ${s}\uFF1F`)&&(await k.styles.where("name").equals(s).delete(),await b())},m=F(()=>c.value?e.value.filter(s=>s.name.includes(c.value)):e.value);return O(b),{newStyleName:r,selectedCategory:o,selectedColors:f,selectedSizes:a,newPrice:u,categories:p,computedColors:V,computedSizes:C,search:c,filteredStyles:m,addNewStyle:q,removeStyle:t}}},ie={class:"font q-pa-md bg-grey-1"},ue={class:"row q-col-gutter-md items-center q-mb-md"},ce={class:"text-bold",style:{"font-size":"3vw"}},de={class:"text-grey"},me={class:"row q-col-gutter-sm q-mt-sm",style:{gap:"1.5vw"}};function fe(r,o,f,a,u,c){return h(),Q("div",ie,[o[6]||(o[6]=w("div",{class:"text-primary q-mb-lg",style:{height:"4vh","font-size":"5vw","font-weight":"bold"}}," \u{1F3A8} \u6B3E\u5F0F\u7BA1\u7406\u4ECB\u9762 ",-1)),i(ne,{onSubmit:te(a.addNewStyle,["prevent"]),style:{"border-bottom":"4px solid #000","padding-bottom":"0.5vh","margin-bottom":"1vh"}},{default:_(()=>[w("div",ue,[i(L,{modelValue:a.selectedCategory,"onUpdate:modelValue":o[0]||(o[0]=e=>a.selectedCategory=e),options:a.categories,label:"\u9078\u64C7\u985E\u5225",outlined:"",dense:"",class:"large-input col-12 col-md-3","popup-content-class":"select-popup"},null,8,["modelValue","options"]),i(X,{modelValue:a.newStyleName,"onUpdate:modelValue":o[1]||(o[1]=e=>a.newStyleName=e),label:"\u65B0\u589E\u6B3E\u865F",outlined:"",dense:"",class:"large-input col-12 col-md-3"},null,8,["modelValue"]),i(L,{modelValue:a.selectedColors,"onUpdate:modelValue":o[2]||(o[2]=e=>a.selectedColors=e),options:a.computedColors,label:"\u9078\u64C7\u984F\u8272",outlined:"",dense:"",multiple:"",class:"large-input col-12 col-md-2","popup-content-class":"select-popup"},null,8,["modelValue","options"]),i(L,{modelValue:a.selectedSizes,"onUpdate:modelValue":o[3]||(o[3]=e=>a.selectedSizes=e),options:a.computedSizes,label:"\u9078\u64C7\u5C3A\u5BF8",outlined:"",dense:"",multiple:"",class:"large-input col-12 col-md-2","popup-content-class":"select-popup"},null,8,["modelValue","options"]),i(X,{modelValue:a.newPrice,"onUpdate:modelValue":o[4]||(o[4]=e=>a.newPrice=e),modelModifiers:{number:!0},type:"number",label:"\u50F9\u683C",outlined:"",dense:"",class:"large-input col-12 col-md-1"},null,8,["modelValue"])]),i(M,{label:"\u65B0\u589E\u6B3E\u5F0F",color:"primary",class:"full-width",type:"submit",style:{"font-size":"3vw"}})]),_:1},8,["onSubmit"]),i(X,{modelValue:a.search,"onUpdate:modelValue":o[5]||(o[5]=e=>a.search=e),label:"\u641C\u5C0B\u6B3E\u865F",outlined:"",dense:"",class:"large-input q-mb-md"},null,8,["modelValue"]),i(oe,{class:"bg-white shadow-1"},{default:_(()=>[i(le,{bordered:"",separator:""},{default:_(()=>[(h(!0),Q(I,null,N(a.filteredStyles,e=>(h(),A(ae,{key:e.name,class:"q-pb-sm"},{default:_(()=>[i(j,null,{default:_(()=>[w("div",ce,[U(" \u6B3E\u865F\uFF1A"+x(e.name)+" ",1),w("span",de,"("+x(e.category)+")",1)]),w("div",me,[(h(!0),Q(I,null,N(e.combinations,(p,S)=>(h(),A(R,{key:S,class:"q-mr-xs q-mb-xs bg-blue-grey-1 text-black",square:"",dense:"",style:{"font-size":"3vw"}},{default:_(()=>[U(x(p.color)+" / "+x(p.size)+" / $"+x(p.price),1)]),_:2},1024))),128))])]),_:2},1024),i(j,{side:"",top:""},{default:_(()=>[i(M,{icon:"delete",color:"negative",flat:"",dense:"",onClick:p=>a.removeStyle(e.name)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])}var he=se(re,[["render",fe],["__scopeId","data-v-1d5ea29c"]]);export{he as default};
